# 학습 노트
---
# DAY0 : 학습 계획 수립
## 프로젝트 주제 : 소켓 통신 학습
## 프로젝트 예상 성과 : 채팅 라이브러리, 클라이언트, 서버의 구현
## 구체적인 목표 : 
1. C언어 등을 이용한 저수준 소켓 통신 라이브러리의 구현
2. 위 라이브러리와 Java SpringBoot 프레임워크를 이용한 채팅 서버의 구현
3. 위 라이브러리와 Python을 이용한 채팅 클라이언트 프로그램의 구현
---
# DAY1 : C 언어를 이용한 저수준 소켓 통신 라이브러리의 구현
## 계획 : 
- 기능 단위로 라이브러리 분할. 
  - client_lib : 클라이언트 어플리케이션에 노출되는 함수, 구조체 등을 정의
  - server_lib : 서버 어플리케이션에 노출되는 함수, 구조체 등을 정의
  - common : 서버, 클라이언트가 공통적으로 사용하는 프로토콜, 파싱 로직 등을 정의
  - socket_lib : 위 ```/client_lib```, ```/server_lib```, ```/common```에서 공통으로 호출하는 커널 함수를 래핑하여 플랫폼 종속성을 통제
- 비동기 채팅 프로그램의 구현을 위하여 ```/common``` 디렉토리에 ```command_queue```를 구현하여 순차적으로 명령어를 처리함
- 헤더와 구현부 분리
  - 각 라이브러리의 ```/include``` 디렉토리에는 외부 모듈, 상위 레이어에 공개할 함수의 시그니처, 구조체의 정의 등을 포함
  - 각 라이브러리의 ```/src``` 디렉토리에는 실제 소스 코드를 포함
- CMake를 이용하여 빌드
---
DAY2 : SpringBoot를 이용한 자바 백엔드 서버 작성
## 계획 : 
- 일반적인 SpringBoot 라이브러리 관습에 따라 패키지 분할.
  - wrapper_library : C 라이브러리를 JAVA 프로젝트에서 사용할 수 있도록 인터페이스를 구현하고, 어플리케이션 레이어에서 직관적으로 활용할 수 있는 API를 다른 패키지에 제공.
  - config : applications.properties 파일과 연동하여 서버 IP, Port와 같은 의존성 주입, wrapper_library의 생명주기를 통제.
  - dto : 어플리케이션 레이어 단위에서, 클라이언트 프로그램과의 통신에 필요한 프로토콜을 정의하고 구현.
  - domain : 서버 어플리케이션 내부적으로 필요한 클래스 정의.
  - runner : 서버 어플리케이션의 전체적인 생명주기를 통제. 
  - service : 비즈니스 로직을 정의.
## 상세 :
- service 패키지는 내부적으로 역할에 따라 ChatService, UserService, FileTransferService로 분할.
- ChatService는 내부적으로 수신한 메시지의 MessageType(C 라이브러리 정의)에 따라 각각의 Handler를 호출하여 클라이언트에 dto를 송신.
- Handler는 클라이언트와 직접적인 통신을 하지 않고, HandlerResult라는 클래스를 반환하여, ChatService에 클라이언트와의 송수신 기능을 집중시켜 계층 간의 역할 분할을 명확히 함.
- 직접 작성한 라이브러리를 사용하기 때문에 플랫폼에 따라 C 라이브러리 파일이 다른데, 이를 JNA 라이브러리를 사용하여 해결함. resources 라이브러리에 플랫폼 코드별로 각각의 라이브러리 파일을 포함하는 구조로 작성. 사용한 노트북이 M1 맥북이기 때문에 ```resources/darwin-aarch64``` 경로에 작성. 추후 다른 플랫폼에서 빌드할 경우, ```resources```  경로에 패키지를 추가하여 확장할 수 있음.
---
## DAY3 : 파이썬을 이용한 클라이언트 프로그램 작성
## 계획 : 
- app : C 라이브러리 래퍼 클래스를 소유하고, 편리하게 사용할 수 있는 인터페이스를 ui 계층에 제공.
- configs : .env 파일로부터 의존성을 주입받고, 다른 패키지에 제공.
- core : C 라이브러리를 파이썬 프로젝트에서 사용할 수 있도록 인터페이스를 구현하고, 어플리케이션 레이어에서 직관적으로 활용할 수 있는 API를 다른 패키지에 제공.
- ui : 사용자가 간편하게 사용할 수 있는 인터페이스 제공.
- main.py : 어플리케이션을 구동.
## 상세 :
- 서버와 유사하게, 수신한 메시지의 MessageType(C 라이브러리 정의)에 따라 각각의 Handler를 호출하여 이벤트를 격발.
- 모든 이벤트는 EventManager에 의해 통제되고, EventType과 EventData를 통해 이벤트의 종류와 작업을 정의함.
- 각각의 계층에서는 EventManager에 구독할 이벤트의 종류와 콜백을 저장하여 실행 흐름을 제어함.
